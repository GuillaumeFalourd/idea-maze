diff --git a/extensions/browser/api/execute_code_function.cc b/extensions/browser/api/execute_code_function.cc
index 9954ce746e..31eec30bea 100644
--- a/extensions/browser/api/execute_code_function.cc
+++ b/extensions/browser/api/execute_code_function.cc
@@ -6,6 +6,7 @@
 #define EXTENSIONS_BROWSER_API_EXECUTE_CODE_FUNCTION_IMPL_H_

 #include "extensions/browser/api/execute_code_function.h"
+#include "content/nw/src/browser/nw_chrome_browser_hooks.h"

 #include <algorithm>
 #include <utility>
@@ -111,6 +112,9 @@ bool ExecuteCodeFunction::Execute(const std::string& code_string,
       break;
   }

+  ScriptExecutor::WorldType world_type = details_->main_world.get() && *details_->main_world
+    ? ScriptExecutor::MAIN_WORLD : ScriptExecutor::ISOLATED_WORLD;
+
   mojom::CodeInjectionPtr injection;
   bool is_css_injection = ShouldInsertCSS() || ShouldRemoveCSS();
   if (is_css_injection) {
@@ -145,6 +149,7 @@ bool ExecuteCodeFunction::Execute(const std::string& code_string,
   executor->ExecuteScript(
       host_id_, std::move(injection), frame_scope, {root_frame_id_},
       match_about_blank, run_at,
+      world_type,
       IsWebView() ? ScriptExecutor::WEB_VIEW_PROCESS
                   : ScriptExecutor::DEFAULT_PROCESS,
       GetWebViewSrc(),
